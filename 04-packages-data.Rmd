# (PART) Demonstration {-}

# Options for running demos
Demo materials can be accessed and run locally in three ways:

## Preferred method: R-Studio Cloud
A cloud workspace and R-project with DWQ's R packages and dependencies pre-installed can be accessed through R-Studio Cloud.  
First, [sign up for an R-Studio account](https://login.rstudio.cloud/register?redirect=https%3A%2F%2Fclient.login.rstudio.cloud%2Foauth%2Flogin%3Fshow_auth%3D0%26show_login%3D1%26show_setup%3D1) if you don't already have one. 
Accounts are free, and logins via existing Google or GitHub accounts are OK.  
Then, access the project for this demonstration at [rstudio.cloud/project/360104](https://rstudio.cloud/project/360104). This link will generate a temorary copy of the demonstration 
project on your account. There you are able to import DWQ R package libraries and run functions and applications.  
For example, 
```{r, eval=F}
library(irTools)
asmntDashboard()
```

## Local install of R & DWQ packages
Install R [r-project.org](https://www.r-project.org/) and/or R-Studio [rstudio.com/products/rstudio/download/](https://www.rstudio.com/products/rstudio/download/) if not already installed on your computer.    
Installing DWQ's R packages from GitHub to your local R installation requires the package, 'devtools'.  
To install devtools & DWQ's R packages:
```{r, eval=F}
install.packages('devtools')
devtools::install_github('utah-dwq/irTools')
library(irTools)
asmntDashboard()
```

## Running Shiny applications via remote server
Applications included in this demo have also been deployed to a remote server where they can be accessed via a web browser without installing R, packages, or creating a login. See the 'Applications' section of this document for more information. 
Note that applications running on the remote server may run a bit slower and time-out after 15 minutes of inactivity.

# Packages & data downloads
## Install & import DWQ's R packages
```{r, packages, eval=F}
devtools::install_github('utah-dwq/wqTools')
devtools::install_github('utah-dwq/irTools')
```

```{r, libraries}
library(wqTools)
library(irTools)
```

## Download and import data
### Data download
```{r, download1, eval=F}
downloadWQP(outfile_path='01-raw-data',start_date='10/01/2008', end_date='09/30/2014', zip=TRUE, unzip=TRUE, retrieve=c("narrowresult", "activity", "detquantlim"))
downloadWQP(outfile_path='01-raw-data', zip=FALSE, retrieve="sites")
```
*Note--* Having an issue downloading sites for POR date range (Unclear why exactly. Seems to be associated applying date query parameters to older sites). Downloading all sites separately, then subsetting to just those included in narrowresult.

```{r, download2, eval=F}
sites=read.csv(file='01-raw-data/sites-2019-04-04.csv')
nr=read.csv(file='01-raw-data/narrowresult-2019-04-04.csv')
sites=sites[sites$MonitoringLocationIdentifier %in% nr$MonitoringLocationIdentifier,]
write.csv(file='01-raw-data/sites-2019-04-04.csv', sites, row.names=F)
rm(sites)
```


### Data imports
Read raw data into R, remove duplicates and check for orphans
```{r, data-import, cache=T}
irdata <- readWQPFiles(file_select=FALSE,
            narrowresult_file = "01-raw-data\\narrowresult-2019-04-04.csv",
            sites_file = "01-raw-data\\sites-2019-04-04.csv",
            activity_file = "01-raw-data\\activity-2019-04-04.csv",
            detquantlim_file = "01-raw-data\\detquantlim-2019-04-04.csv",
            orph_check = TRUE)

objects(irdata)
```


